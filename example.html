
<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <title>Intercom - Example</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type='text/javascript' src='intercom.js'></script>

    <script type='text/javascript'>
      $(document).ready(function() {
        var tower = {};

        Intercom.installOn(tower);

        tower.listen('activated', function(which) {
          activate(which);
        });

        tower.listen('deactivated', function(which) {
          deactivate(which);
        });

        $('.plane').each(function(i){
          $(this).attr('data-color', 'rgba('+Math.floor(Math.random() * ((255-10)+1) + 10) +','+ Math.floor(Math.random() * ((255-10)+1) + 10)+','+ Math.floor(Math.random() * ((255-10)+1) + 10)+', 0.8)');
          $(this).html('<div>plane '+i+'</div>').css({'background': $(this).attr('data-color')});
          $(this).on('mousedown', function() {
            $(this).css({'background':'white'});
            tower.broadcast('activated', $(this).attr('data-color'));
          });
          $(this).on('mouseup', function() {
            $(this).css({'background':$(this).attr('data-color')});
            tower.broadcast('deactivated');
          })
        });

        var activate = function(which) {
          console.log('active', which);
          $('.plane').each(function() {
            if(which != $(this).attr('data-color')) {
              $(this).css({'background':which});
            }
          })
        };
        var deactivate = function(which) {
          $('.plane').each(function() {
            $(this).css({'background':$(this).attr('data-color')});
          })
        };
      })
    </script>
    <style>
      body { background-color: whitesmoke;}
      .plane { 
        width: 25%;
        height: 150px;
        text-align: center;
        display: flex;
        align-content: center;
        float: left;
        box-sizing: border-box;
        cursor: pointer;
        border: 5px solid whitesmoke;
        border-radius: 10px;
        transition: all 0.4s ease;
      }
      .plane div {
        display: flex;
        align-self: center;
        margin: auto;
        text-transform: uppercase;
        letter-spacing: 3px;
        font-family: arial, helvetica, sans-serif;
      }
    </style>
  </head>
  <body class="body">
    <div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div><div class="plane"></div>
    <div class="plane"></div>
    
  </body>
</html>
